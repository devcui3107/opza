function Opza(options={}){this.opt={templateId:null,content:"",widthModal:null,closeTrigger:["button","overlay","Escape"],scrollLock:true,destroy:false,cssContainer:[],footerContent:"",buttons:[],...options};this._isOpen=false;this._closeTriggerType=["button","overlay","Escape"];this._closeTriggerMap={button:false,overlay:false,Escape:false};this.opt.closeTrigger.forEach((nameType=>{if(!this._closeTriggerType.includes(nameType)){console.warn(`"${nameType}" does not exist in the modal close option`)}else{this._closeTriggerMap[nameType]=true}}));if(this.opt.templateId){this.templateContent=document.querySelector(`#${this.opt.templateId}`)}else if(this.opt.content){this._HtmlStringContent=this.opt.content}else{console.error(`You need to pass in templateId or content: "HTML String"`);return}}Opza._openModals=[];Opza.prototype._getScrollbarWidth=function(){if(this._scrollbarWidth)return this._scrollbarWidth;const div=document.createElement("div");div.style.cssText=`\n      position: absolute;\n      top: -9999px;\n      width:100px;\n      height: 100px;\n      overflow: scroll;\n  `;document.body.append(div);this._scrollbarWidth=div.offsetWidth-div.clientWidth;document.body.removeChild(div);return this._scrollbarWidth||0};Opza.prototype._updateContent=function(htmlString,newContent){return htmlString.replace(/>(.*?)</,`>${newContent}<`)};Opza.prototype._sanitizeAttributes=function(el){Array.from(el.attributes).forEach((attr=>{if((attr.name==="href"||attr.name==="src")&&attr.value.trim().toLowerCase().startsWith("javascript:")){el.removeAttribute(attr.name)}}))};Opza.prototype._sanitizeContent=function(wrapper){const elements=wrapper.querySelectorAll("[href], [src]");elements.forEach(this._sanitizeAttributes.bind(this))};Opza.prototype._createElement=function(tag,classNames=""){const element=document.createElement(tag);if(typeof classNames==="string"){element.className=classNames}else if(Array.isArray(classNames)){element.classList.add(...classNames)}return element};Opza.prototype._hasScrollBar=function(){return document.body.scrollHeight>document.body.clientHeight||document.documentElement.scrollHeight>document.documentElement.clientHeight};Opza.prototype._build=function(){this._opza=this._createElement("div","opza");this._opzaBox=this._createElement("div","opza__box");this._opzaContent=this._createElement("div","opza__content");if(this.opt.widthModal){this._opzaBox.style.width=this.opt.widthModal}else{this._opzaBox.style.width="500px"}if(this.templateContent){const contentModal=this.templateContent.content.cloneNode(true);this._opzaContent.append(contentModal)}if(this._HtmlStringContent){const wrapper=this._createElement("div",this.opt.cssContainer);this._sanitizeContent(wrapper);wrapper.innerHTML=this._HtmlStringContent;this._opzaContent.appendChild(wrapper)}if(this._closeTriggerMap.button){const btnClose=this._createElement("button","opza__btn-close");btnClose.innerHTML="&times;";this._opzaBox.append(btnClose);btnClose.onclick=()=>this.close()}if(this.opt.footerContent){const opzaFooter=this._createElement("div","opza__footerContent");this._sanitizeContent(opzaFooter);opzaFooter.innerHTML=this.opt.footerContent;this._opzaContent.append(opzaFooter)}if(this.opt.buttons){if(!this._opzaButtons){this._opzaButtons=this._createElement("div","opza__buttons")}this.opt.buttons.forEach((btn=>{const button=this._createElement("button",btn.cssName);button.innerText=btn.label;button.onclick=()=>{if(!btn.preAction||btn.preAction()){btn.action()}};this._opzaButtons.append(button);this._opzaContent.append(this._opzaButtons)}))}this._opzaBox.append(this._opzaContent);this._opza.append(this._opzaBox);document.body.append(this._opza)};Opza.prototype.open=function(){if(this._isOpen)return;this._isOpen=true;Opza._openModals.push(this);if(!this._opza){this._build()}this._opza.style.zIndex=1e3+Opza._openModals.length;setTimeout((()=>{this._opza.classList.add("opza--show");if(this.opt.scrollLock&&Opza._openModals.length===1&&Opza.prototype._hasScrollBar()){const paddingRightTarget=parseInt(getComputedStyle(document.body).paddingRight);document.body.classList.add("opza--no-scroll");document.body.style.paddingRight=paddingRightTarget+this._getScrollbarWidth()+"px"}if(this._closeTriggerMap.overlay){this._handleClickOverlay=e=>{if(e.target===this._opza)this.close()};this._opza.addEventListener("click",this._handleClickOverlay)}if(this._closeTriggerMap.Escape){this._handlePressEscape=e=>{const lastModal=Opza._openModals[Opza._openModals.length-1];if(e.key==="Escape"&&this===lastModal)this.close()};document.addEventListener("keydown",this._handlePressEscape)}}),0)};Opza.prototype.close=function(sttDestroy=this.opt.destroy){if(!this._isOpen)return;this._isOpen=false;this._opza.classList.remove("opza--show");const iframes=this._opza.querySelectorAll("iframe");iframes.forEach((iframe=>{const src=iframe.getAttribute("src");iframe.setAttribute("src","");iframe.setAttribute("src",src)}));Opza._openModals.pop();if(this.opt.scrollLock&&Opza._openModals.length===0){this._opza.addEventListener("transitionend",(()=>{document.body.classList.remove("opza--no-scroll");document.body.style.paddingRight=""}),{once:true})}if(this._handleClickOverlay){this._opza.removeEventListener("click",this._handleClickOverlay);this._handleClickOverlay=null}if(this._handlePressEscape){document.removeEventListener("keydown",this._handlePressEscape);this._handlePressEscape=null}if(sttDestroy){this._opza.addEventListener("transitionend",(()=>{this.destroy()}),{once:true})}};Opza.prototype.destroy=function(){if(this._opza){this._opza.remove();this._opza=null;this._opzaButtons=null}};Opza.prototype.footerContentEdit=function(newContent){if(this.opt.footerContent){const oldContent=this.opt.footerContent;const htmlNewContent=this._updateContent(oldContent,newContent);this.opt.footerContent=htmlNewContent;if(this._opza){const footerElement=this._opza.querySelector(".opza__footerContent");if(footerElement){footerElement.innerHTML=newContent}}}};Opza.prototype.buttonsEdit=function(index,newLabel,newCssName,newPreAction,newAction){if(this.opt.buttons){const btnContainer=document.querySelector(".opza__buttons");const btnItem=btnContainer.querySelectorAll("button")[index];if(newLabel){btnItem.innerText=newLabel}if(newCssName){btnItem.className=newCssName}if(newPreAction){btnItem.preAction=newPreAction}if(newAction){btnItem.onclick=function(){if(btnItem.preAction){btnItem.preAction()}if(newAction){newAction()}}}}};